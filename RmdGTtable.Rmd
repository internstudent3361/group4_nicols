---
title: "Rubber Duck GT Table"
output: html_document
---

Now that we have worked out the formula for each data set, we wanted to visualise it into a table. This ensured that we had all the correct values for each group. Firstly, we placed the data into a tibble, starting with the religious sample.

We then listed the characteristics that this table focused on such as % claimed and sacredness before placing the variable names under the appropriate columns. After doing so, we used the mutate_if function to round the values to 2 decimal places. The function is.numeric specifies that this will only apply to columns with numeric values. Finally, we used the GT function to plot it into a table and gave it an appropriate title using cols_label.

```{r eval=FALSE}
print("Don't run me")

#Making the tables
#Make religious table
table1 <- tibble(
  characteristics = c("% claimed", "Sacredness", "Negativity", "Positivity", "Tempo", "Impact"),
  M = c(mean4c, mean4s, mean4n, mean4p, mean4t, mean4i),
  SD = c(sd4c, sd4s, sd4n, sd4p, sd4t, sd4i),
  lCI = c(lCI4c, lCI4s, lCI4n, lCI4p, lCI4t, lCI4i),
  uCI = c(uCI4c, uCI4s, uCI4n, uCI4p, uCI4t, uCI4i),
  d = c("-", "-", "-", "-", "-", "-")
) 

table1 %>% mutate_if(is.numeric, ~round(., 2)) %>%
  gt() %>%
  cols_label(characteristics = "Religious") 
```

We then applied this to the secular, white noise and control groups. The "c" specifies the values of each column, which match up with the characteristics column.

```{r eval=FALSE}
print("Don't run me")

#Make secular table
table2 <- tibble(
  characteristics = c("% claimed", "Sacredness", "Negativity", "Positivity", "Tempo", "Impact"),
  M = c(mean3c, mean3s, mean3n, mean3p, mean3t, mean3i),
  SD = c(sd3c, sd3s, sd3n, sd3p, sd3t, sd3i),
  lCI = c(lCI3c, lCI3s, lCI3n, lCI3p, lCI3t, lCI3i),
  uCI = c(uCI3c, uCI3s, uCI3n, uCI3p, uCI3t, uCI3i),
  d = c(d1c, d1s, d1n, d1p, d1t, d1i)
)

table2 %>% mutate_if(is.numeric, ~round(., 2)) %>%
  gt() %>%
  cols_label(characteristics = "Secular")

#Make white noise table
table3 <- tibble(
  characteristics = c("% claimed", "Sacredness", "Negativity", "Positivity", "Tempo", "Impact"),
  M = c(mean2c, mean2s, mean2n, mean2p, mean2t, mean2i),
  SD = c(sd2c, sd2s, sd2n, sd2p, sd2t, sd2i),
  lCI = c(lCI2c, lCI2s, lCI2n, lCI2p, lCI2t, lCI2i),
  uCI = c(uCI2c, uCI2s, uCI2n, uCI2p, uCI2t, uCI2i),
  d = c(d2c, d2s, d2n, d2p, d2t, d2i)
)

table3 %>% mutate_if(is.numeric, ~round(., 2)) %>%
  gt() %>%
  cols_label(characteristics = "White Noise")

#Make control group table
table4 <- tibble(
  characteristics = c("% claimed", "Sacredness", "Negativity", "Positivity", "Tempo", "Impact"),
  M = c(mean1c, NA, NA, NA, NA, NA),
  SD = c(sd1c, NA, NA, NA, NA, NA),
  lCI = c(lCI1c, NA, NA, NA, NA, NA),
  uCI = c(uCI1c, NA, NA, NA, NA, NA),
  d = c(d3c, NA, NA, NA, NA, NA)
)

table4 %>% mutate_if(is.numeric, ~round(., 2)) %>%
  gt() %>%
  cols_label(characteristics = "Control Group")

```

After this, we needed to merge the tables together. I found that using the data.frame was the easiest. It collected all the variables from all four tables, and made a collection that was similar to a matrix. 

```{r eval=FALSE}
print("Don't run me")

data_tables <- data.frame(Religious = table1, 
                          Secular = table2,
                          WhiteNoise = table3,
                          Control = table4)
```

Building upon that, we used the function gt(data_tables) to have R understand what data frame we wanted to use. By inputting the function tab_source_note(source_note = ...), we were able to place text at the bottom of the table, similar to the original. The function tab_spanner(label = ...,columns = c()) allowed us to place a label that spans across a certain amount of columns. This enabled us to label the columns that pertain to each group. 

```{r eval=FALSE}
print("Don't run me")

gt_tbl <- gt(data_tables) %>% 
  tab_source_note(
    source_note = "M = Mean; SD = Standard Deviation; CI = 95% Confidence Intervals. Cohen's d represents the effect size of comparisons between musical conditions.") %>%
  tab_spanner(
    label = "Religious (n = 102)",
    columns = c(Religious.M, Religious.SD, Religious.lCI, Religious.uCI, Religious.d)
  ) %>%
  tab_spanner(
    label = "Secular (n = 103)",
    columns = c(Secular.M, Secular.SD, Secular.lCI, Secular.uCI, Secular.d)
  ) %>%
  tab_spanner(
    label = "White Noise (n = 103)",
    columns = c(WhiteNoise.M, WhiteNoise.SD, WhiteNoise.lCI, WhiteNoise.uCI, WhiteNoise.d)
  ) %>%
  tab_spanner(
    label = "Control (n = 100)",
    columns = c(Control.M, Control.SD, Control.lCI, Control.uCI, Control.d)
  )
```

Moving on from this, we needed to name the columns appropriately with M, SD, lCI, uCI and d. This was completed using the function cols_label, where the original name of the column is overridden, and the words in the speech marks ("") set the new name.

```{r eval=FALSE}
print("Don't run me")

cols_label(Religious.characteristics = NULL, 
             Religious.M = "M",
             Religious.SD = "SD",
             Religious.lCI = "lCI",
             Religious.uCI = "uCI",
             Religious.d = "d",
             Secular.characteristics = "Secular",
             Secular.M = "M",
             Secular.SD = "SD",
             Secular.lCI = "lCI",
             Secular.uCI = "uCI",
             Secular.d = "d",
             WhiteNoise.characteristics = "White Noise",
             WhiteNoise.M = "M",
             WhiteNoise.SD = "SD",
             WhiteNoise.lCI = "lCI",
             WhiteNoise.uCI = "uCI",
             WhiteNoise.d = "d",
             Control.characteristics = "Control",
             Control.M = "M",
             Control.SD = "SD",
             Control.lCI = "lCI",
             Control.uCI = "uCI",
             Control.d = "d")
```

We needed to ensure that all values were rounded to two decimal places. This was achieved using fmt_number on columns with numeric values. This was difficult for values that were marked with a "-" initially, as they were not calculated by the researchers. By coming back to the original table visualisation and changing the "-" into NA, the function fmt_number finally worked. This was applied to each column and use_seps was set to false as we did not want any digit group separators. The exact function is: fmt_number(columns = ..., decimals = 2, use_seps = FALSE).

```{r eval=FALSE}
print("Don't run me")

fmt_number(
    columns = Religious.M,
    decimals = 2,
    use_seps = FALSE
  ) %>% 

  fmt_number(
    columns = Religious.SD,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Religious.lCI,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Religious.uCI,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Secular.M,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Secular.SD,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Secular.lCI,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Secular.uCI,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = Secular.d,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = WhiteNoise.M,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = WhiteNoise.SD,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = WhiteNoise.lCI,
    decimals = 2,
    use_seps = FALSE
  ) %>% 
  
  fmt_number(
    columns = WhiteNoise.uCI,
    decimals = 2,
    use_seps = FALSE
  ) %>%
  
  fmt_number(
    columns = WhiteNoise.d,
    decimals = 2,
    use_seps = FALSE
  ) %>%
  
  fmt_number(
    columns = Control.M,
    decimals = 2,
    use_seps = FALSE,
  ) %>%
  
  fmt_number(
    columns =  Control.SD,
    decimals = 2,
    use_seps = FALSE
  ) %>%
  
  fmt_number(
    columns = Control.lCI,
    decimals = 2,
    use_seps = FALSE
  ) %>%
  
  fmt_number(
    columns = Control.uCI,
    decimals = 2,
    use_seps = FALSE
  ) %>%
  
  fmt_number(
    columns = Control.d,
    decimals = 2,
    use_seps = FALSE
  )
```

Finally, the very last thing to do was hide columns that repeated the %%claimed, sacredness, negativity, positivity, tempo and impact characteristics. This occurred as each group initially had their own separate table. We achieved this by using the function cols_hide(columns = c(...)).

```{r eval=FALSE}
print("Don't run me")

cols_hide(
    columns = c(Secular.characteristics, WhiteNoise.characteristics, Control.characteristics))
```